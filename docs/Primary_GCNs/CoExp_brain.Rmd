---
title: "CoExp_brain"
author: "Amy Hicks"
date: "15/10/2021"
output:
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
    df_print: paged
---

```{r setup, include=FALSE}
library(CoExpNets)
library(CoExpGTEx)
library(CoExp10UKBEC)
library(biomaRt)
library(tidyverse)
library(knitr)
library(ggplot2)
library(here)
knitr::opts_chunk$set(echo = TRUE)
```

The NSL genes were searched in all available gene co-expression networks created from brain tissue transcriptomic data from GTEx version 6 and UKBEC databases.

```{r, results = FALSE}
# First initialise the datasets/packages to use
CoExpGTEx::initDb(mandatory = T)
CoExp10UKBEC::initDb(mandatory = T)
```

```{r}
# Return the tissues (networks) available within select dataset
getAvailableNetworks(category = "gtexv6")
getAvailableNetworks(category = "10UKBEC")
```

# 1. Gene list
```{r}
# Load gene list
NSL_list <- read.delim(file.path(here::here("data", "Gene_lists", "NSL_list.txt")))
# Make gene list vector
NSL_genes <- as.character(NSL_list$Gene_symbol)
```

# 2. GTEx
## 2.1. All CNS regions {.tabset}
### Amygdala
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Amygdala_report_gt <- reportOnGenes(tissue = "Amygdala", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Amygdala_rep_gt <- Amygdala_report_gt$report
Amygdala_rep_gt_length <- nrow(Amygdala_rep_gt)
# Convert report into table
Amygdala_rep_gt <- data.frame(matrix(unlist(Amygdala_rep_gt), nrow = Amygdala_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Amygdala_rep_gt)[1] <- "Gene"
names(Amygdala_rep_gt)[2] <- "ENSG"
names(Amygdala_rep_gt)[3] <- "MM"
names(Amygdala_rep_gt)[4] <- "Module"
names(Amygdala_rep_gt)[5] <- "Size"
names(Amygdala_rep_gt)[6] <- "GO_report"
names(Amygdala_rep_gt)[7] <- "PD_genes"
names(Amygdala_rep_gt)[8] <- "Preservation"
names(Amygdala_rep_gt)[9] <- "Cell_type"
names(Amygdala_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Amygdala_gt_fig <- data.frame(Amygdala_rep_gt$Gene, Amygdala_rep_gt$Module, Amygdala_rep_gt$Fisher)
names(Amygdala_gt_fig)[names(Amygdala_gt_fig)=="Amygdala_rep_gt.Fisher"] <- "p.val"
names(Amygdala_gt_fig)[names(Amygdala_gt_fig)=="Amygdala_rep_gt.Module"] <- "module"
names(Amygdala_gt_fig)[names(Amygdala_gt_fig)=="Amygdala_rep_gt.Gene"] <- "gene"
# Format columns
Amygdala_gt_fig$p.val <- as.numeric(Amygdala_gt_fig$p.val)
Amygdala_gt_fig$module <- as.character(Amygdala_gt_fig$module)
Amygdala_gt_fig$gene <- as.character(Amygdala_gt_fig$gene)
Amygdala_gt_fig <- dplyr::arrange(Amygdala_gt_fig, module)
Amygdala_gt_fig$position <- nrow(Amygdala_gt_fig):1
Amygdala_gt_fig$`-log10(p.val)` <- -log10(Amygdala_gt_fig$p.val)
Amygdala_gt_fig$FDR <- p.adjust(Amygdala_gt_fig$p.val, method = "fdr")
Amygdala_gt_fig$`-log10(FDR)` <- -log10(Amygdala_gt_fig$FDR)
# Create graph
source("~/NSL_PD_relationships/scripts/CoExp_functions.R")
ggplot(Amygdala_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Amygdala", y = "Module", x = "Gene")
```

### Anterior Cingulate Cortex
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
AntCingCortex_report_gt <- reportOnGenes(tissue = "AntCingCortex", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
AntCingCortex_rep_gt <- AntCingCortex_report_gt$report
AntCingCortex_rep_gt_length <- nrow(AntCingCortex_rep_gt)
# Convert report into table
AntCingCortex_rep_gt <- data.frame(matrix(unlist(AntCingCortex_rep_gt), nrow = AntCingCortex_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(AntCingCortex_rep_gt)[1] <- "Gene"
names(AntCingCortex_rep_gt)[2] <- "ENSG"
names(AntCingCortex_rep_gt)[3] <- "MM"
names(AntCingCortex_rep_gt)[4] <- "Module"
names(AntCingCortex_rep_gt)[5] <- "Size"
names(AntCingCortex_rep_gt)[6] <- "GO_report"
names(AntCingCortex_rep_gt)[7] <- "PD_genes"
names(AntCingCortex_rep_gt)[8] <- "Preservation"
names(AntCingCortex_rep_gt)[9] <- "Cell_type"
names(AntCingCortex_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
AntCingCortex_gt_fig <- data.frame(AntCingCortex_rep_gt$Gene, AntCingCortex_rep_gt$Module, AntCingCortex_rep_gt$Fisher)
names(AntCingCortex_gt_fig)[names(AntCingCortex_gt_fig)=="AntCingCortex_rep_gt.Fisher"] <- "p.val"
names(AntCingCortex_gt_fig)[names(AntCingCortex_gt_fig)=="AntCingCortex_rep_gt.Module"] <- "module"
names(AntCingCortex_gt_fig)[names(AntCingCortex_gt_fig)=="AntCingCortex_rep_gt.Gene"] <- "gene"
# Format columns
AntCingCortex_gt_fig$p.val <- as.numeric(AntCingCortex_gt_fig$p.val)
AntCingCortex_gt_fig$module <- as.character(AntCingCortex_gt_fig$module)
AntCingCortex_gt_fig$gene <- as.character(AntCingCortex_gt_fig$gene)
AntCingCortex_gt_fig <- dplyr::arrange(AntCingCortex_gt_fig, module)
AntCingCortex_gt_fig$position <- nrow(AntCingCortex_gt_fig):1
AntCingCortex_gt_fig$`-log10(p.val)` <- -log10(AntCingCortex_gt_fig$p.val)
AntCingCortex_gt_fig$FDR <- p.adjust(AntCingCortex_gt_fig$p.val, method = "fdr")
AntCingCortex_gt_fig$`-log10(FDR)` <- -log10(AntCingCortex_gt_fig$FDR)
# Create graph
ggplot(AntCingCortex_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Anterior cingulate cortex", y = "Module", x = "Gene")
```

### Caudate
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Caudate_report_gt <- reportOnGenes(tissue = "Caudate", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Caudate_rep_gt <- Caudate_report_gt$report
Caudate_rep_gt_length <- nrow(Caudate_rep_gt)
# Convert report into table
Caudate_rep_gt <- data.frame(matrix(unlist(Caudate_rep_gt), nrow = Caudate_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Caudate_rep_gt)[1] <- "Gene"
names(Caudate_rep_gt)[2] <- "ENSG"
names(Caudate_rep_gt)[3] <- "MM"
names(Caudate_rep_gt)[4] <- "Module"
names(Caudate_rep_gt)[5] <- "Size"
names(Caudate_rep_gt)[6] <- "GO_report"
names(Caudate_rep_gt)[7] <- "PD_genes"
names(Caudate_rep_gt)[8] <- "Preservation"
names(Caudate_rep_gt)[9] <- "Cell_type"
names(Caudate_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Caudate_gt_fig <- data.frame(Caudate_rep_gt$Gene, Caudate_rep_gt$Module, Caudate_rep_gt$Fisher)
names(Caudate_gt_fig)[names(Caudate_gt_fig)=="Caudate_rep_gt.Fisher"] <- "p.val"
names(Caudate_gt_fig)[names(Caudate_gt_fig)=="Caudate_rep_gt.Module"] <- "module"
names(Caudate_gt_fig)[names(Caudate_gt_fig)=="Caudate_rep_gt.Gene"] <- "gene"
# Format columns
Caudate_gt_fig$p.val <- as.numeric(Caudate_gt_fig$p.val)
Caudate_gt_fig$module <- as.character(Caudate_gt_fig$module)
Caudate_gt_fig$gene <- as.character(Caudate_gt_fig$gene)
Caudate_gt_fig <- dplyr::arrange(Caudate_gt_fig, module)
Caudate_gt_fig$position <- nrow(Caudate_gt_fig):1
Caudate_gt_fig$`-log10(p.val)` <- -log10(Caudate_gt_fig$p.val)
Caudate_gt_fig$FDR <- p.adjust(Caudate_gt_fig$p.val, method = "fdr")
Caudate_gt_fig$`-log10(FDR)` <- -log10(Caudate_gt_fig$FDR)
# Create graph
ggplot(Caudate_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Caudate", y = "Module", x = "Gene")
```

### Cerebellum
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Cerebellum_report_gt <- reportOnGenes(tissue = "Cerebellum", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Cerebellum_rep_gt <- Cerebellum_report_gt$report
Cerebellum_rep_gt_length <- nrow(Cerebellum_rep_gt)
# Convert report into table
Cerebellum_rep_gt <- data.frame(matrix(unlist(Cerebellum_rep_gt), nrow = Cerebellum_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Cerebellum_rep_gt)[1] <- "Gene"
names(Cerebellum_rep_gt)[2] <- "ENSG"
names(Cerebellum_rep_gt)[3] <- "MM"
names(Cerebellum_rep_gt)[4] <- "Module"
names(Cerebellum_rep_gt)[5] <- "Size"
names(Cerebellum_rep_gt)[6] <- "GO_report"
names(Cerebellum_rep_gt)[7] <- "PD_genes"
names(Cerebellum_rep_gt)[8] <- "Preservation"
names(Cerebellum_rep_gt)[9] <- "Cell_type"
names(Cerebellum_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Cerebellum_gt_fig <- data.frame(Cerebellum_rep_gt$Gene, Cerebellum_rep_gt$Module, Cerebellum_rep_gt$Fisher)
names(Cerebellum_gt_fig)[names(Cerebellum_gt_fig)=="Cerebellum_rep_gt.Fisher"] <- "p.val"
names(Cerebellum_gt_fig)[names(Cerebellum_gt_fig)=="Cerebellum_rep_gt.Module"] <- "module"
names(Cerebellum_gt_fig)[names(Cerebellum_gt_fig)=="Cerebellum_rep_gt.Gene"] <- "gene"
# Format columns
Cerebellum_gt_fig$p.val <- as.numeric(Cerebellum_gt_fig$p.val)
Cerebellum_gt_fig$module <- as.character(Cerebellum_gt_fig$module)
Cerebellum_gt_fig$gene <- as.character(Cerebellum_gt_fig$gene)
Cerebellum_gt_fig <- dplyr::arrange(Cerebellum_gt_fig, module)
Cerebellum_gt_fig$position <- nrow(Cerebellum_gt_fig):1
Cerebellum_gt_fig$`-log10(p.val)` <- -log10(Cerebellum_gt_fig$p.val)
Cerebellum_gt_fig$FDR <- p.adjust(Cerebellum_gt_fig$p.val, method = "fdr")
Cerebellum_gt_fig$`-log10(FDR)` <- -log10(Cerebellum_gt_fig$FDR)
# Create graph
ggplot(Cerebellum_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Cerebellum", y = "Module", x = "Gene")
```

### Cerebellar Hemisphere
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
CerebHemisphere_report_gt <- reportOnGenes(tissue = "CerebHemisphere", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
CerebHemisphere_rep_gt <- CerebHemisphere_report_gt$report
CerebHemisphere_rep_gt_length <- nrow(CerebHemisphere_rep_gt)
# Convert report into table
CerebHemisphere_rep_gt <- data.frame(matrix(unlist(CerebHemisphere_rep_gt), nrow = CerebHemisphere_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(CerebHemisphere_rep_gt)[1] <- "Gene"
names(CerebHemisphere_rep_gt)[2] <- "ENSG"
names(CerebHemisphere_rep_gt)[3] <- "MM"
names(CerebHemisphere_rep_gt)[4] <- "Module"
names(CerebHemisphere_rep_gt)[5] <- "Size"
names(CerebHemisphere_rep_gt)[6] <- "GO_report"
names(CerebHemisphere_rep_gt)[7] <- "PD_genes"
names(CerebHemisphere_rep_gt)[8] <- "Preservation"
names(CerebHemisphere_rep_gt)[9] <- "Cell_type"
names(CerebHemisphere_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
CerebHemisphere_gt_fig <- data.frame(CerebHemisphere_rep_gt$Gene, CerebHemisphere_rep_gt$Module, CerebHemisphere_rep_gt$Fisher)
names(CerebHemisphere_gt_fig)[names(CerebHemisphere_gt_fig)=="CerebHemisphere_rep_gt.Fisher"] <- "p.val"
names(CerebHemisphere_gt_fig)[names(CerebHemisphere_gt_fig)=="CerebHemisphere_rep_gt.Module"] <- "module"
names(CerebHemisphere_gt_fig)[names(CerebHemisphere_gt_fig)=="CerebHemisphere_rep_gt.Gene"] <- "gene"
# Format columns
CerebHemisphere_gt_fig$p.val <- as.numeric(CerebHemisphere_gt_fig$p.val)
CerebHemisphere_gt_fig$module <- as.character(CerebHemisphere_gt_fig$module)
CerebHemisphere_gt_fig$gene <- as.character(CerebHemisphere_gt_fig$gene)
CerebHemisphere_gt_fig <- dplyr::arrange(CerebHemisphere_gt_fig, module)
CerebHemisphere_gt_fig$position <- nrow(CerebHemisphere_gt_fig):1
CerebHemisphere_gt_fig$`-log10(p.val)` <- -log10(CerebHemisphere_gt_fig$p.val)
CerebHemisphere_gt_fig$FDR <- p.adjust(CerebHemisphere_gt_fig$p.val, method = "fdr")
CerebHemisphere_gt_fig$`-log10(FDR)` <- -log10(CerebHemisphere_gt_fig$FDR)
# Create graph
ggplot(CerebHemisphere_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Cerebellar hemisphere", y = "Module", x = "Gene")
```

### Cortex
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Cortex_report_gt <- reportOnGenes(tissue = "Cortex", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Cortex_rep_gt <- Cortex_report_gt$report
Cortex_rep_gt_length <- nrow(Cortex_rep_gt)
# Convert report into table
Cortex_rep_gt <- data.frame(matrix(unlist(Cortex_rep_gt), nrow = Cortex_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Cortex_rep_gt)[1] <- "Gene"
names(Cortex_rep_gt)[2] <- "ENSG"
names(Cortex_rep_gt)[3] <- "MM"
names(Cortex_rep_gt)[4] <- "Module"
names(Cortex_rep_gt)[5] <- "Size"
names(Cortex_rep_gt)[6] <- "GO_report"
names(Cortex_rep_gt)[7] <- "PD_genes"
names(Cortex_rep_gt)[8] <- "Preservation"
names(Cortex_rep_gt)[9] <- "Cell_type"
names(Cortex_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Cortex_gt_fig <- data.frame(Cortex_rep_gt$Gene, Cortex_rep_gt$Module, Cortex_rep_gt$Fisher)
names(Cortex_gt_fig)[names(Cortex_gt_fig)=="Cortex_rep_gt.Fisher"] <- "p.val"
names(Cortex_gt_fig)[names(Cortex_gt_fig)=="Cortex_rep_gt.Module"] <- "module"
names(Cortex_gt_fig)[names(Cortex_gt_fig)=="Cortex_rep_gt.Gene"] <- "gene"
# Format columns
Cortex_gt_fig$p.val <- as.numeric(Cortex_gt_fig$p.val)
Cortex_gt_fig$module <- as.character(Cortex_gt_fig$module)
Cortex_gt_fig$gene <- as.character(Cortex_gt_fig$gene)
Cortex_gt_fig <- dplyr::arrange(Cortex_gt_fig, module)
Cortex_gt_fig$position <- nrow(Cortex_gt_fig):1
Cortex_gt_fig$`-log10(p.val)` <- -log10(Cortex_gt_fig$p.val)
Cortex_gt_fig$FDR <- p.adjust(Cortex_gt_fig$p.val, method = "fdr")
Cortex_gt_fig$`-log10(FDR)` <- -log10(Cortex_gt_fig$FDR)
# Create graph
ggplot(Cortex_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Cortex", y = "Module", x = "Gene")
```

### Frontal Cortex
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
FCortex_report_gt <- reportOnGenes(tissue = "FCortex", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
FCortex_rep_gt <- FCortex_report_gt$report
FCortex_rep_gt_length <- nrow(FCortex_rep_gt)
# Convert report into table
FCortex_rep_gt <- data.frame(matrix(unlist(FCortex_rep_gt), nrow = FCortex_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(FCortex_rep_gt)[1] <- "Gene"
names(FCortex_rep_gt)[2] <- "ENSG"
names(FCortex_rep_gt)[3] <- "MM"
names(FCortex_rep_gt)[4] <- "Module"
names(FCortex_rep_gt)[5] <- "Size"
names(FCortex_rep_gt)[6] <- "GO_report"
names(FCortex_rep_gt)[7] <- "PD_genes"
names(FCortex_rep_gt)[8] <- "Preservation"
names(FCortex_rep_gt)[9] <- "Cell_type"
names(FCortex_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
FCortex_gt_fig <- data.frame(FCortex_rep_gt$Gene, FCortex_rep_gt$Module, FCortex_rep_gt$Fisher)
names(FCortex_gt_fig)[names(FCortex_gt_fig)=="FCortex_rep_gt.Fisher"] <- "p.val"
names(FCortex_gt_fig)[names(FCortex_gt_fig)=="FCortex_rep_gt.Module"] <- "module"
names(FCortex_gt_fig)[names(FCortex_gt_fig)=="FCortex_rep_gt.Gene"] <- "gene"
# Format columns
FCortex_gt_fig$p.val <- as.numeric(FCortex_gt_fig$p.val)
FCortex_gt_fig$module <- as.character(FCortex_gt_fig$module)
FCortex_gt_fig$gene <- as.character(FCortex_gt_fig$gene)
FCortex_gt_fig <- dplyr::arrange(FCortex_gt_fig, module)
FCortex_gt_fig$position <- nrow(FCortex_gt_fig):1
FCortex_gt_fig$`-log10(p.val)` <- -log10(FCortex_gt_fig$p.val)
FCortex_gt_fig$FDR <- p.adjust(FCortex_gt_fig$p.val, method = "fdr")
FCortex_gt_fig$`-log10(FDR)` <- -log10(FCortex_gt_fig$FDR)
# Create graph
ggplot(FCortex_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3") +
  labs(title = "Frontal cortex", y = "Module", x = "Gene")
```

### Hippocampus
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Hippocampus_report_gt <- reportOnGenes(tissue = "Hippocampus", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Hippocampus_rep_gt <- Hippocampus_report_gt$report
Hippocampus_rep_gt_length <- nrow(Hippocampus_rep_gt)
# Convert report into table
Hippocampus_rep_gt <- data.frame(matrix(unlist(Hippocampus_rep_gt), nrow = Hippocampus_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Hippocampus_rep_gt)[1] <- "Gene"
names(Hippocampus_rep_gt)[2] <- "ENSG"
names(Hippocampus_rep_gt)[3] <- "MM"
names(Hippocampus_rep_gt)[4] <- "Module"
names(Hippocampus_rep_gt)[5] <- "Size"
names(Hippocampus_rep_gt)[6] <- "GO_report"
names(Hippocampus_rep_gt)[7] <- "PD_genes"
names(Hippocampus_rep_gt)[8] <- "Preservation"
names(Hippocampus_rep_gt)[9] <- "Cell_type"
names(Hippocampus_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Hippocampus_gt_fig <- data.frame(Hippocampus_rep_gt$Gene, Hippocampus_rep_gt$Module, Hippocampus_rep_gt$Fisher)
names(Hippocampus_gt_fig)[names(Hippocampus_gt_fig)=="Hippocampus_rep_gt.Fisher"] <- "p.val"
names(Hippocampus_gt_fig)[names(Hippocampus_gt_fig)=="Hippocampus_rep_gt.Module"] <- "module"
names(Hippocampus_gt_fig)[names(Hippocampus_gt_fig)=="Hippocampus_rep_gt.Gene"] <- "gene"
# Format columns
Hippocampus_gt_fig$p.val <- as.numeric(Hippocampus_gt_fig$p.val)
Hippocampus_gt_fig$module <- as.character(Hippocampus_gt_fig$module)
Hippocampus_gt_fig$gene <- as.character(Hippocampus_gt_fig$gene)
Hippocampus_gt_fig <- dplyr::arrange(Hippocampus_gt_fig, module)
Hippocampus_gt_fig$position <- nrow(Hippocampus_gt_fig):1
Hippocampus_gt_fig$`-log10(p.val)` <- -log10(Hippocampus_gt_fig$p.val)
Hippocampus_gt_fig$FDR <- p.adjust(Hippocampus_gt_fig$p.val, method = "fdr")
Hippocampus_gt_fig$`-log10(FDR)` <- -log10(Hippocampus_gt_fig$FDR)
# Create graph
ggplot(Hippocampus_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Hippocampus", y = "Module", x = "Gene")
```

### Hypothalamus
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Hypothalamus_report_gt <- reportOnGenes(tissue = "Hypothalamus", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Hypothalamus_rep_gt <- Hypothalamus_report_gt$report
Hypothalamus_rep_gt_length <- nrow(Hypothalamus_rep_gt)
# Convert report into table
Hypothalamus_rep_gt <- data.frame(matrix(unlist(Hypothalamus_rep_gt), nrow = Hypothalamus_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Hypothalamus_rep_gt)[1] <- "Gene"
names(Hypothalamus_rep_gt)[2] <- "ENSG"
names(Hypothalamus_rep_gt)[3] <- "MM"
names(Hypothalamus_rep_gt)[4] <- "Module"
names(Hypothalamus_rep_gt)[5] <- "Size"
names(Hypothalamus_rep_gt)[6] <- "GO_report"
names(Hypothalamus_rep_gt)[7] <- "PD_genes"
names(Hypothalamus_rep_gt)[8] <- "Preservation"
names(Hypothalamus_rep_gt)[9] <- "Cell_type"
names(Hypothalamus_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Hypothalamus_gt_fig <- data.frame(Hypothalamus_rep_gt$Gene, Hypothalamus_rep_gt$Module, Hypothalamus_rep_gt$Fisher)
names(Hypothalamus_gt_fig)[names(Hypothalamus_gt_fig)=="Hypothalamus_rep_gt.Fisher"] <- "p.val"
names(Hypothalamus_gt_fig)[names(Hypothalamus_gt_fig)=="Hypothalamus_rep_gt.Module"] <- "module"
names(Hypothalamus_gt_fig)[names(Hypothalamus_gt_fig)=="Hypothalamus_rep_gt.Gene"] <- "gene"
# Format columns
Hypothalamus_gt_fig$p.val <- as.numeric(Hypothalamus_gt_fig$p.val)
Hypothalamus_gt_fig$module <- as.character(Hypothalamus_gt_fig$module)
Hypothalamus_gt_fig$gene <- as.character(Hypothalamus_gt_fig$gene)
Hypothalamus_gt_fig <- dplyr::arrange(Hypothalamus_gt_fig, module)
Hypothalamus_gt_fig$position <- nrow(Hypothalamus_gt_fig):1
Hypothalamus_gt_fig$`-log10(p.val)` <- -log10(Hypothalamus_gt_fig$p.val)
Hypothalamus_gt_fig$FDR <- p.adjust(Hypothalamus_gt_fig$p.val, method = "fdr")
Hypothalamus_gt_fig$`-log10(FDR)` <- -log10(Hypothalamus_gt_fig$FDR)
# Create graph
ggplot(Hypothalamus_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Hypothalamus", y = "Module", x = "Gene")
```

### Nucleus Accumbens
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
NucAccumbens_report_gt <- reportOnGenes(tissue = "NucAccumbens", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
NucAccumbens_rep_gt <- NucAccumbens_report_gt$report
NucAccumbens_rep_gt_length <- nrow(NucAccumbens_rep_gt)
# Convert report into table
NucAccumbens_rep_gt <- data.frame(matrix(unlist(NucAccumbens_rep_gt), nrow = NucAccumbens_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(NucAccumbens_rep_gt)[1] <- "Gene"
names(NucAccumbens_rep_gt)[2] <- "ENSG"
names(NucAccumbens_rep_gt)[3] <- "MM"
names(NucAccumbens_rep_gt)[4] <- "Module"
names(NucAccumbens_rep_gt)[5] <- "Size"
names(NucAccumbens_rep_gt)[6] <- "GO_report"
names(NucAccumbens_rep_gt)[7] <- "PD_genes"
names(NucAccumbens_rep_gt)[8] <- "Preservation"
names(NucAccumbens_rep_gt)[9] <- "Cell_type"
names(NucAccumbens_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
NucAccumbens_gt_fig <- data.frame(NucAccumbens_rep_gt$Gene, NucAccumbens_rep_gt$Module, NucAccumbens_rep_gt$Fisher)
names(NucAccumbens_gt_fig)[names(NucAccumbens_gt_fig)=="NucAccumbens_rep_gt.Fisher"] <- "p.val"
names(NucAccumbens_gt_fig)[names(NucAccumbens_gt_fig)=="NucAccumbens_rep_gt.Module"] <- "module"
names(NucAccumbens_gt_fig)[names(NucAccumbens_gt_fig)=="NucAccumbens_rep_gt.Gene"] <- "gene"
# Format columns
NucAccumbens_gt_fig$p.val <- as.numeric(NucAccumbens_gt_fig$p.val)
NucAccumbens_gt_fig$module <- as.character(NucAccumbens_gt_fig$module)
NucAccumbens_gt_fig$gene <- as.character(NucAccumbens_gt_fig$gene)
NucAccumbens_gt_fig <- dplyr::arrange(NucAccumbens_gt_fig, module)
NucAccumbens_gt_fig$position <- nrow(NucAccumbens_gt_fig):1
NucAccumbens_gt_fig$`-log10(p.val)` <- -log10(NucAccumbens_gt_fig$p.val)
NucAccumbens_gt_fig$FDR <- p.adjust(NucAccumbens_gt_fig$p.val, method = "fdr")
NucAccumbens_gt_fig$`-log10(FDR)` <- -log10(NucAccumbens_gt_fig$FDR)
# Create graph
ggplot(NucAccumbens_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Nucleus accumbens", y = "Module", x = "Gene")
```

### Putamen
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Putamen_report_gt <- reportOnGenes(tissue = "Putamen", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Putamen_rep_gt <- Putamen_report_gt$report
Putamen_rep_gt_length <- nrow(Putamen_rep_gt)
# Convert report into table
Putamen_rep_gt <- data.frame(matrix(unlist(Putamen_rep_gt), nrow = Putamen_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Putamen_rep_gt)[1] <- "Gene"
names(Putamen_rep_gt)[2] <- "ENSG"
names(Putamen_rep_gt)[3] <- "MM"
names(Putamen_rep_gt)[4] <- "Module"
names(Putamen_rep_gt)[5] <- "Size"
names(Putamen_rep_gt)[6] <- "GO_report"
names(Putamen_rep_gt)[7] <- "PD_genes"
names(Putamen_rep_gt)[8] <- "Preservation"
names(Putamen_rep_gt)[9] <- "Cell_type"
names(Putamen_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Putamen_gt_fig <- data.frame(Putamen_rep_gt$Gene, Putamen_rep_gt$Module, Putamen_rep_gt$Fisher)
names(Putamen_gt_fig)[names(Putamen_gt_fig)=="Putamen_rep_gt.Fisher"] <- "p.val"
names(Putamen_gt_fig)[names(Putamen_gt_fig)=="Putamen_rep_gt.Module"] <- "module"
names(Putamen_gt_fig)[names(Putamen_gt_fig)=="Putamen_rep_gt.Gene"] <- "gene"
# Format columns
Putamen_gt_fig$p.val <- as.numeric(Putamen_gt_fig$p.val)
Putamen_gt_fig$module <- as.character(Putamen_gt_fig$module)
Putamen_gt_fig$gene <- as.character(Putamen_gt_fig$gene)
Putamen_gt_fig <- dplyr::arrange(Putamen_gt_fig, module)
Putamen_gt_fig$position <- nrow(Putamen_gt_fig):1
Putamen_gt_fig$`-log10(p.val)` <- -log10(Putamen_gt_fig$p.val)
Putamen_gt_fig$FDR <- p.adjust(Putamen_gt_fig$p.val, method = "fdr")
Putamen_gt_fig$`-log10(FDR)` <- -log10(Putamen_gt_fig$FDR)
# Create graph
ggplot(Putamen_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Putamen", y = "Module", x = "Gene")
```

### Spinal cord
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Spinalcord_report_gt <- reportOnGenes(tissue = "Spinalcord", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Spinalcord_rep_gt <- Spinalcord_report_gt$report
Spinalcord_rep_gt_length <- nrow(Spinalcord_rep_gt)
# Convert report into table
Spinalcord_rep_gt <- data.frame(matrix(unlist(Spinalcord_rep_gt), nrow = Spinalcord_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Spinalcord_rep_gt)[1] <- "Gene"
names(Spinalcord_rep_gt)[2] <- "ENSG"
names(Spinalcord_rep_gt)[3] <- "MM"
names(Spinalcord_rep_gt)[4] <- "Module"
names(Spinalcord_rep_gt)[5] <- "Size"
names(Spinalcord_rep_gt)[6] <- "GO_report"
names(Spinalcord_rep_gt)[7] <- "PD_genes"
names(Spinalcord_rep_gt)[8] <- "Preservation"
names(Spinalcord_rep_gt)[9] <- "Cell_type"
names(Spinalcord_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Spinalcord_gt_fig <- data.frame(Spinalcord_rep_gt$Gene, Spinalcord_rep_gt$Module, Spinalcord_rep_gt$Fisher)
names(Spinalcord_gt_fig)[names(Spinalcord_gt_fig)=="Spinalcord_rep_gt.Fisher"] <- "p.val"
names(Spinalcord_gt_fig)[names(Spinalcord_gt_fig)=="Spinalcord_rep_gt.Module"] <- "module"
names(Spinalcord_gt_fig)[names(Spinalcord_gt_fig)=="Spinalcord_rep_gt.Gene"] <- "gene"
# Format columns
Spinalcord_gt_fig$p.val <- as.numeric(Spinalcord_gt_fig$p.val)
Spinalcord_gt_fig$module <- as.character(Spinalcord_gt_fig$module)
Spinalcord_gt_fig$gene <- as.character(Spinalcord_gt_fig$gene)
Spinalcord_gt_fig <- dplyr::arrange(Spinalcord_gt_fig, module)
Spinalcord_gt_fig$position <- nrow(Spinalcord_gt_fig):1
Spinalcord_gt_fig$`-log10(p.val)` <- -log10(Spinalcord_gt_fig$p.val)
Spinalcord_gt_fig$FDR <- p.adjust(Spinalcord_gt_fig$p.val, method = "fdr")
Spinalcord_gt_fig$`-log10(FDR)` <- -log10(Spinalcord_gt_fig$FDR)
# Create graph
ggplot(Spinalcord_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white", limits = c(0,1)) +
  labs(title = "Spinal cord", y = "Module", x = "Gene")
```

### Substantia Nigra
```{r, results = FALSE, warning = FALSE}
# Search genes of interest in specified tissue/network 
Substantianigra_report_gt <- reportOnGenes(tissue = "Substantianigra", genes = NSL_genes, which.one = "gtexv6", ens.correction = c("ENSG00000257382", "ENSG00000120071"))
Substantianigra_rep_gt <- Substantianigra_report_gt$report
Substantianigra_rep_gt_length <- nrow(Substantianigra_rep_gt)
# Convert report into table
Substantianigra_rep_gt <- data.frame(matrix(unlist(Substantianigra_rep_gt), nrow = Substantianigra_rep_gt_length, byrow = FALSE), stringsAsFactors=FALSE)
names(Substantianigra_rep_gt)[1] <- "Gene"
names(Substantianigra_rep_gt)[2] <- "ENSG"
names(Substantianigra_rep_gt)[3] <- "MM"
names(Substantianigra_rep_gt)[4] <- "Module"
names(Substantianigra_rep_gt)[5] <- "Size"
names(Substantianigra_rep_gt)[6] <- "GO_report"
names(Substantianigra_rep_gt)[7] <- "PD_genes"
names(Substantianigra_rep_gt)[8] <- "Preservation"
names(Substantianigra_rep_gt)[9] <- "Cell_type"
names(Substantianigra_rep_gt)[10] <- "Fisher"
```

```{r}
# Extract columns of interest
Substantianigra_gt_fig <- data.frame(Substantianigra_rep_gt$Gene, Substantianigra_rep_gt$Module, Substantianigra_rep_gt$Fisher)
names(Substantianigra_gt_fig)[names(Substantianigra_gt_fig)=="Substantianigra_rep_gt.Fisher"] <- "p.val"
names(Substantianigra_gt_fig)[names(Substantianigra_gt_fig)=="Substantianigra_rep_gt.Module"] <- "module"
names(Substantianigra_gt_fig)[names(Substantianigra_gt_fig)=="Substantianigra_rep_gt.Gene"] <- "gene"
# Format columns
Substantianigra_gt_fig$p.val <- as.numeric(Substantianigra_gt_fig$p.val)
Substantianigra_gt_fig$module <- as.character(Substantianigra_gt_fig$module)
Substantianigra_gt_fig$gene <- as.character(Substantianigra_gt_fig$gene)
Substantianigra_gt_fig <- dplyr::arrange(Substantianigra_gt_fig, module)
Substantianigra_gt_fig$position <- nrow(Substantianigra_gt_fig):1
Substantianigra_gt_fig$`-log10(p.val)` <- -log10(Substantianigra_gt_fig$p.val)
Substantianigra_gt_fig$FDR <- p.adjust(Substantianigra_gt_fig$p.val, method = "fdr")
Substantianigra_gt_fig$`-log10(FDR)` <- -log10(Substantianigra_gt_fig$FDR)
# Create graph
ggplot(Substantianigra_gt_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3", limits = c(0,5)) +
  labs(title = "Substantia nigra", y = "Module", x = "Gene")
```

## 2.2. Summary
```{r}
# Join together
Amygdala_gt_fig$Tissue <- "Amygdala"
AntCingCortex_gt_fig$Tissue <- "Anterior Cingulate Cortex"
Caudate_gt_fig$Tissue <- "Caudate"
Cerebellum_gt_fig$Tissue <- "Cerebellum"
CerebHemisphere_gt_fig$Tissue <- "Cerebellar Hemisphere"
Cortex_gt_fig$Tissue <- "Cortex"
FCortex_gt_fig$Tissue <- "Frontal Cortex"
Hippocampus_gt_fig$Tissue <- "Hippocampus"
Hypothalamus_gt_fig$Tissue <- "Hypothalamus"
NucAccumbens_gt_fig$Tissue <- "Nucleus Accumbens"
Putamen_gt_fig$Tissue <- "Putamen"
Spinalcord_gt_fig$Tissue <- "Spinal Cord"
Substantianigra_gt_fig$Tissue <- "Substantia Nigra"
sumfig <- do.call(rbind, list(Amygdala_gt_fig, AntCingCortex_gt_fig, Caudate_gt_fig, Cerebellum_gt_fig, CerebHemisphere_gt_fig,
                              Cortex_gt_fig, FCortex_gt_fig, Hippocampus_gt_fig, Hypothalamus_gt_fig, NucAccumbens_gt_fig,
                              Putamen_gt_fig, Spinalcord_gt_fig, Substantianigra_gt_fig))

# Format columns
sumfig$gene <- as.character(sumfig$gene)
sumfig$`-log10(FDR)` <- as.numeric(sumfig$`-log10(FDR)`)
sumfig$FDR <- as.numeric(sumfig$FDR)
sumfig$Position <- nrow(sumfig):1
# Plot
ggplot(sumfig, aes(gene, module)) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR)), size = 2) +
  scale_fill_gradient(low = "white", high = "goldenrod3") +
  labs(y = "Module", x = "Gene") +
  facet_grid(Tissue ~ ., scales = "free", space = "free") +
  theme(strip.text.y = element_text(angle = 0), axis.text = element_text(size = 6))
```

# 3. UKBEC

```{r}
# Modify NSL list to include known gene aliases 
NSL_list$uk_symbol <- as.character(NSL_list$Gene_symbol)
NSL_list$uk_symbol[NSL_list$uk_symbol=="KANSL1"] <- "KIAA1267"
NSL_list$uk_symbol[NSL_list$uk_symbol=="KAT8"] <- "MYST1"
NSL_list$uk_symbol[NSL_list$uk_symbol=="KANSL2"] <- "C12orf41"
NSL_list$uk_symbol[NSL_list$uk_symbol=="KANSL3"] <- "KIAA1310"
NSL_uk_genes <- as.character(NSL_list$uk_symbol)
```

## 3.1. All CNS regions {.tabset}
### Cerebellum
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
CRBL_report_uk <- reportOnGenes(tissue = "CRBL", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
CRBL_rep_uk <- CRBL_report_uk$report
# Count the number of genes in the output
CRBL_rep_uk_length <- nrow(CRBL_rep_uk)
# Convert report to table
CRBL_rep_uk <- data.frame(matrix(unlist(CRBL_rep_uk), nrow = CRBL_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(CRBL_rep_uk)[1] <- "Gene"
names(CRBL_rep_uk)[2] <- "ENSG"
names(CRBL_rep_uk)[3] <- "MM"
names(CRBL_rep_uk)[4] <- "Module"
names(CRBL_rep_uk)[5] <- "Size"
names(CRBL_rep_uk)[6] <- "GO_report"
names(CRBL_rep_uk)[7] <- "PD_genes"
names(CRBL_rep_uk)[8] <- "Preservation"
names(CRBL_rep_uk)[9] <- "Cell_type"
names(CRBL_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  CRBL_rep_uk$Gene[CRBL_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
CRBL_uk_fig <- data.frame(CRBL_rep_uk$Gene, CRBL_rep_uk$Module, CRBL_rep_uk$Fisher)
names(CRBL_uk_fig)[names(CRBL_uk_fig)=="CRBL_rep_uk.Fisher"] <- "p.val"
names(CRBL_uk_fig)[names(CRBL_uk_fig)=="CRBL_rep_uk.Module"] <- "module"
names(CRBL_uk_fig)[names(CRBL_uk_fig)=="CRBL_rep_uk.Gene"] <- "gene"
# Format columns
CRBL_uk_fig$p.val <- as.numeric(CRBL_uk_fig$p.val)
CRBL_uk_fig$module <- as.character(CRBL_uk_fig$module)
CRBL_uk_fig$gene <- as.character(CRBL_uk_fig$gene)
CRBL_uk_fig <- dplyr::arrange(CRBL_uk_fig, module)
CRBL_uk_fig$position <- nrow(CRBL_uk_fig):1
CRBL_uk_fig$`-log10(p.val)` <- -log10(CRBL_uk_fig$p.val)
CRBL_uk_fig$FDR <- p.adjust(CRBL_uk_fig$p.val, method = "fdr")
CRBL_uk_fig$`-log10(FDR)` <- -log10(CRBL_uk_fig$FDR)
# Create graph
ggplot(CRBL_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Cerebellum", y = "Module", x = "Gene")
```

### Frontal cortex
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
FCTX_report_uk <- reportOnGenes(tissue = "FCTX", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
FCTX_rep_uk <- FCTX_report_uk$report
# Count the number of genes in the output
FCTX_rep_uk_length <- nrow(FCTX_rep_uk)
# Convert report to table
FCTX_rep_uk <- data.frame(matrix(unlist(FCTX_rep_uk), nrow = FCTX_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(FCTX_rep_uk)[1] <- "Gene"
names(FCTX_rep_uk)[2] <- "ENSG"
names(FCTX_rep_uk)[3] <- "MM"
names(FCTX_rep_uk)[4] <- "Module"
names(FCTX_rep_uk)[5] <- "Size"
names(FCTX_rep_uk)[6] <- "GO_report"
names(FCTX_rep_uk)[7] <- "PD_genes"
names(FCTX_rep_uk)[8] <- "Preservation"
names(FCTX_rep_uk)[9] <- "Cell_type"
names(FCTX_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  FCTX_rep_uk$Gene[FCTX_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
FCTX_uk_fig <- data.frame(FCTX_rep_uk$Gene, FCTX_rep_uk$Module, FCTX_rep_uk$Fisher)
names(FCTX_uk_fig)[names(FCTX_uk_fig)=="FCTX_rep_uk.Fisher"] <- "p.val"
names(FCTX_uk_fig)[names(FCTX_uk_fig)=="FCTX_rep_uk.Module"] <- "module"
names(FCTX_uk_fig)[names(FCTX_uk_fig)=="FCTX_rep_uk.Gene"] <- "gene"
# Format columns
FCTX_uk_fig$p.val <- as.numeric(FCTX_uk_fig$p.val)
FCTX_uk_fig$module <- as.character(FCTX_uk_fig$module)
FCTX_uk_fig$gene <- as.character(FCTX_uk_fig$gene)
FCTX_uk_fig <- dplyr::arrange(FCTX_uk_fig, module)
FCTX_uk_fig$position <- nrow(FCTX_uk_fig):1
FCTX_uk_fig$`-log10(p.val)` <- -log10(FCTX_uk_fig$p.val)
FCTX_uk_fig$FDR <- p.adjust(FCTX_uk_fig$p.val, method = "fdr")
FCTX_uk_fig$`-log10(FDR)` <- -log10(FCTX_uk_fig$FDR)
# Create graph
ggplot(FCTX_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3") +
  labs(title = "Frontal cortex", y = "Module", x = "Gene")
```

### Hippocampus
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
HIPP_report_uk <- reportOnGenes(tissue = "HIPP", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
HIPP_rep_uk <- HIPP_report_uk$report
# Count the number of genes in the output
HIPP_rep_uk_length <- nrow(HIPP_rep_uk)
# Convert report to table
HIPP_rep_uk <- data.frame(matrix(unlist(HIPP_rep_uk), nrow = HIPP_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(HIPP_rep_uk)[1] <- "Gene"
names(HIPP_rep_uk)[2] <- "ENSG"
names(HIPP_rep_uk)[3] <- "MM"
names(HIPP_rep_uk)[4] <- "Module"
names(HIPP_rep_uk)[5] <- "Size"
names(HIPP_rep_uk)[6] <- "GO_report"
names(HIPP_rep_uk)[7] <- "PD_genes"
names(HIPP_rep_uk)[8] <- "Preservation"
names(HIPP_rep_uk)[9] <- "Cell_type"
names(HIPP_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  HIPP_rep_uk$Gene[HIPP_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
HIPP_uk_fig <- data.frame(HIPP_rep_uk$Gene, HIPP_rep_uk$Module, HIPP_rep_uk$Fisher)
names(HIPP_uk_fig)[names(HIPP_uk_fig)=="HIPP_rep_uk.Fisher"] <- "p.val"
names(HIPP_uk_fig)[names(HIPP_uk_fig)=="HIPP_rep_uk.Module"] <- "module"
names(HIPP_uk_fig)[names(HIPP_uk_fig)=="HIPP_rep_uk.Gene"] <- "gene"
# Format columns
HIPP_uk_fig$p.val <- as.numeric(HIPP_uk_fig$p.val)
HIPP_uk_fig$module <- as.character(HIPP_uk_fig$module)
HIPP_uk_fig$gene <- as.character(HIPP_uk_fig$gene)
HIPP_uk_fig <- dplyr::arrange(HIPP_uk_fig, module)
HIPP_uk_fig$position <- nrow(HIPP_uk_fig):1
HIPP_uk_fig$`-log10(p.val)` <- -log10(HIPP_uk_fig$p.val)
HIPP_uk_fig$FDR <- p.adjust(HIPP_uk_fig$p.val, method = "fdr")
HIPP_uk_fig$`-log10(FDR)` <- -log10(HIPP_uk_fig$FDR)
# Create graph
ggplot(HIPP_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "white", high = "goldenrod3") +
  labs(title = "Hippocampus", y = "Module", x = "Gene")
```

### Medulla
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
MEDU_report_uk <- reportOnGenes(tissue = "MEDU", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
MEDU_rep_uk <- MEDU_report_uk$report
# Count the number of genes in the output
MEDU_rep_uk_length <- nrow(MEDU_rep_uk)
# Convert report to table
MEDU_rep_uk <- data.frame(matrix(unlist(MEDU_rep_uk), nrow = MEDU_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(MEDU_rep_uk)[1] <- "Gene"
names(MEDU_rep_uk)[2] <- "ENSG"
names(MEDU_rep_uk)[3] <- "MM"
names(MEDU_rep_uk)[4] <- "Module"
names(MEDU_rep_uk)[5] <- "Size"
names(MEDU_rep_uk)[6] <- "GO_report"
names(MEDU_rep_uk)[7] <- "PD_genes"
names(MEDU_rep_uk)[8] <- "Preservation"
names(MEDU_rep_uk)[9] <- "Cell_type"
names(MEDU_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  MEDU_rep_uk$Gene[MEDU_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
MEDU_uk_fig <- data.frame(MEDU_rep_uk$Gene, MEDU_rep_uk$Module, MEDU_rep_uk$Fisher)
names(MEDU_uk_fig)[names(MEDU_uk_fig)=="MEDU_rep_uk.Fisher"] <- "p.val"
names(MEDU_uk_fig)[names(MEDU_uk_fig)=="MEDU_rep_uk.Module"] <- "module"
names(MEDU_uk_fig)[names(MEDU_uk_fig)=="MEDU_rep_uk.Gene"] <- "gene"
# Format columns
MEDU_uk_fig$p.val <- as.numeric(MEDU_uk_fig$p.val)
MEDU_uk_fig$module <- as.character(MEDU_uk_fig$module)
MEDU_uk_fig$gene <- as.character(MEDU_uk_fig$gene)
MEDU_uk_fig <- dplyr::arrange(MEDU_uk_fig, module)
MEDU_uk_fig$position <- nrow(MEDU_uk_fig):1
MEDU_uk_fig$`-log10(p.val)` <- -log10(MEDU_uk_fig$p.val)
MEDU_uk_fig$FDR <- p.adjust(MEDU_uk_fig$p.val, method = "fdr")
MEDU_uk_fig$`-log10(FDR)` <- -log10(MEDU_uk_fig$FDR)
# Create graph
ggplot(MEDU_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Medulla", y = "Module", x = "Gene")
```

### Occipital cortex
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
OCTX_report_uk <- reportOnGenes(tissue = "OCTX", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
OCTX_rep_uk <- OCTX_report_uk$report
# Count the number of genes in the output
OCTX_rep_uk_length <- nrow(OCTX_rep_uk)
# Convert report to table
OCTX_rep_uk <- data.frame(matrix(unlist(OCTX_rep_uk), nrow = OCTX_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(OCTX_rep_uk)[1] <- "Gene"
names(OCTX_rep_uk)[2] <- "ENSG"
names(OCTX_rep_uk)[3] <- "MM"
names(OCTX_rep_uk)[4] <- "Module"
names(OCTX_rep_uk)[5] <- "Size"
names(OCTX_rep_uk)[6] <- "GO_report"
names(OCTX_rep_uk)[7] <- "PD_genes"
names(OCTX_rep_uk)[8] <- "Preservation"
names(OCTX_rep_uk)[9] <- "Cell_type"
names(OCTX_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  OCTX_rep_uk$Gene[OCTX_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
OCTX_uk_fig <- data.frame(OCTX_rep_uk$Gene, OCTX_rep_uk$Module, OCTX_rep_uk$Fisher)
names(OCTX_uk_fig)[names(OCTX_uk_fig)=="OCTX_rep_uk.Fisher"] <- "p.val"
names(OCTX_uk_fig)[names(OCTX_uk_fig)=="OCTX_rep_uk.Module"] <- "module"
names(OCTX_uk_fig)[names(OCTX_uk_fig)=="OCTX_rep_uk.Gene"] <- "gene"
# Format columns
OCTX_uk_fig$p.val <- as.numeric(OCTX_uk_fig$p.val)
OCTX_uk_fig$module <- as.character(OCTX_uk_fig$module)
OCTX_uk_fig$gene <- as.character(OCTX_uk_fig$gene)
OCTX_uk_fig <- dplyr::arrange(OCTX_uk_fig, module)
OCTX_uk_fig$position <- nrow(OCTX_uk_fig):1
OCTX_uk_fig$`-log10(p.val)` <- -log10(OCTX_uk_fig$p.val)
OCTX_uk_fig$FDR <- p.adjust(OCTX_uk_fig$p.val, method = "fdr")
OCTX_uk_fig$`-log10(FDR)` <- -log10(OCTX_uk_fig$FDR)
# Create graph
ggplot(OCTX_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Occipital cortex", y = "Module", x = "Gene")
```

### Putamen
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
PUTM_report_uk <- reportOnGenes(tissue = "PUTM", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
PUTM_rep_uk <- PUTM_report_uk$report
# Count the number of genes in the output
PUTM_rep_uk_length <- nrow(PUTM_rep_uk)
# Convert report to table
PUTM_rep_uk <- data.frame(matrix(unlist(PUTM_rep_uk), nrow = PUTM_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(PUTM_rep_uk)[1] <- "Gene"
names(PUTM_rep_uk)[2] <- "ENSG"
names(PUTM_rep_uk)[3] <- "MM"
names(PUTM_rep_uk)[4] <- "Module"
names(PUTM_rep_uk)[5] <- "Size"
names(PUTM_rep_uk)[6] <- "GO_report"
names(PUTM_rep_uk)[7] <- "PD_genes"
names(PUTM_rep_uk)[8] <- "Preservation"
names(PUTM_rep_uk)[9] <- "Cell_type"
names(PUTM_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  PUTM_rep_uk$Gene[PUTM_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
PUTM_uk_fig <- data.frame(PUTM_rep_uk$Gene, PUTM_rep_uk$Module, PUTM_rep_uk$Fisher)
names(PUTM_uk_fig)[names(PUTM_uk_fig)=="PUTM_rep_uk.Fisher"] <- "p.val"
names(PUTM_uk_fig)[names(PUTM_uk_fig)=="PUTM_rep_uk.Module"] <- "module"
names(PUTM_uk_fig)[names(PUTM_uk_fig)=="PUTM_rep_uk.Gene"] <- "gene"
# Format columns
PUTM_uk_fig$p.val <- as.numeric(PUTM_uk_fig$p.val)
PUTM_uk_fig$module <- as.character(PUTM_uk_fig$module)
PUTM_uk_fig$gene <- as.character(PUTM_uk_fig$gene)
PUTM_uk_fig <- dplyr::arrange(PUTM_uk_fig, module)
PUTM_uk_fig$position <- nrow(PUTM_uk_fig):1
PUTM_uk_fig$`-log10(p.val)` <- -log10(PUTM_uk_fig$p.val)
PUTM_uk_fig$FDR <- p.adjust(PUTM_uk_fig$p.val, method = "fdr")
PUTM_uk_fig$`-log10(FDR)` <- -log10(PUTM_uk_fig$FDR)
# Create graph
ggplot(PUTM_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Putamen", y = "Module", x = "Gene")
```

### Substantia nigra
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
SNIG_report_uk <- reportOnGenes(tissue = "SNIG", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
SNIG_rep_uk <- SNIG_report_uk$report
# Count the number of genes in the output
SNIG_rep_uk_length <- nrow(SNIG_rep_uk)
# Convert report to table
SNIG_rep_uk <- data.frame(matrix(unlist(SNIG_rep_uk), nrow = SNIG_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(SNIG_rep_uk)[1] <- "Gene"
names(SNIG_rep_uk)[2] <- "ENSG"
names(SNIG_rep_uk)[3] <- "MM"
names(SNIG_rep_uk)[4] <- "Module"
names(SNIG_rep_uk)[5] <- "Size"
names(SNIG_rep_uk)[6] <- "GO_report"
names(SNIG_rep_uk)[7] <- "PD_genes"
names(SNIG_rep_uk)[8] <- "Preservation"
names(SNIG_rep_uk)[9] <- "Cell_type"
names(SNIG_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  SNIG_rep_uk$Gene[SNIG_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
SNIG_uk_fig <- data.frame(SNIG_rep_uk$Gene, SNIG_rep_uk$Module, SNIG_rep_uk$Fisher)
names(SNIG_uk_fig)[names(SNIG_uk_fig)=="SNIG_rep_uk.Fisher"] <- "p.val"
names(SNIG_uk_fig)[names(SNIG_uk_fig)=="SNIG_rep_uk.Module"] <- "module"
names(SNIG_uk_fig)[names(SNIG_uk_fig)=="SNIG_rep_uk.Gene"] <- "gene"
# Format columns
SNIG_uk_fig$p.val <- as.numeric(SNIG_uk_fig$p.val)
SNIG_uk_fig$module <- as.character(SNIG_uk_fig$module)
SNIG_uk_fig$gene <- as.character(SNIG_uk_fig$gene)
SNIG_uk_fig <- dplyr::arrange(SNIG_uk_fig, module)
SNIG_uk_fig$position <- nrow(SNIG_uk_fig):1
SNIG_uk_fig$`-log10(p.val)` <- -log10(SNIG_uk_fig$p.val)
SNIG_uk_fig$FDR <- p.adjust(SNIG_uk_fig$p.val, method = "fdr")
SNIG_uk_fig$`-log10(FDR)` <- -log10(SNIG_uk_fig$FDR)
# Create graph
ggplot(SNIG_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Substantia nigra", y = "Module", x = "Gene")
```

### Temporal cortex
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
TCTX_report_uk <- reportOnGenes(tissue = "TCTX", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
TCTX_rep_uk <- TCTX_report_uk$report
# Count the number of genes in the output
TCTX_rep_uk_length <- nrow(TCTX_rep_uk)
# Convert report to table
TCTX_rep_uk <- data.frame(matrix(unlist(TCTX_rep_uk), nrow = TCTX_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(TCTX_rep_uk)[1] <- "Gene"
names(TCTX_rep_uk)[2] <- "ENSG"
names(TCTX_rep_uk)[3] <- "MM"
names(TCTX_rep_uk)[4] <- "Module"
names(TCTX_rep_uk)[5] <- "Size"
names(TCTX_rep_uk)[6] <- "GO_report"
names(TCTX_rep_uk)[7] <- "PD_genes"
names(TCTX_rep_uk)[8] <- "Preservation"
names(TCTX_rep_uk)[9] <- "Cell_type"
names(TCTX_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  TCTX_rep_uk$Gene[TCTX_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
TCTX_uk_fig <- data.frame(TCTX_rep_uk$Gene, TCTX_rep_uk$Module, TCTX_rep_uk$Fisher)
names(TCTX_uk_fig)[names(TCTX_uk_fig)=="TCTX_rep_uk.Fisher"] <- "p.val"
names(TCTX_uk_fig)[names(TCTX_uk_fig)=="TCTX_rep_uk.Module"] <- "module"
names(TCTX_uk_fig)[names(TCTX_uk_fig)=="TCTX_rep_uk.Gene"] <- "gene"
# Format columns
TCTX_uk_fig$p.val <- as.numeric(TCTX_uk_fig$p.val)
TCTX_uk_fig$module <- as.character(TCTX_uk_fig$module)
TCTX_uk_fig$gene <- as.character(TCTX_uk_fig$gene)
TCTX_uk_fig <- dplyr::arrange(TCTX_uk_fig, module)
TCTX_uk_fig$position <- nrow(TCTX_uk_fig):1
TCTX_uk_fig$`-log10(p.val)` <- -log10(TCTX_uk_fig$p.val)
TCTX_uk_fig$FDR <- p.adjust(TCTX_uk_fig$p.val, method = "fdr")
TCTX_uk_fig$`-log10(FDR)` <- -log10(TCTX_uk_fig$FDR)
# Create graph
ggplot(TCTX_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Temporal cortex", y = "Module", x = "Gene")
```

### Thalamus
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
THAL_report_uk <- reportOnGenes(tissue = "THAL", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
THAL_rep_uk <- THAL_report_uk$report
# Count the number of genes in the output
THAL_rep_uk_length <- nrow(THAL_rep_uk)
# Convert report to table
THAL_rep_uk <- data.frame(matrix(unlist(THAL_rep_uk), nrow = THAL_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(THAL_rep_uk)[1] <- "Gene"
names(THAL_rep_uk)[2] <- "ENSG"
names(THAL_rep_uk)[3] <- "MM"
names(THAL_rep_uk)[4] <- "Module"
names(THAL_rep_uk)[5] <- "Size"
names(THAL_rep_uk)[6] <- "GO_report"
names(THAL_rep_uk)[7] <- "PD_genes"
names(THAL_rep_uk)[8] <- "Preservation"
names(THAL_rep_uk)[9] <- "Cell_type"
names(THAL_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  THAL_rep_uk$Gene[THAL_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
THAL_uk_fig <- data.frame(THAL_rep_uk$Gene, THAL_rep_uk$Module, THAL_rep_uk$Fisher)
names(THAL_uk_fig)[names(THAL_uk_fig)=="THAL_rep_uk.Fisher"] <- "p.val"
names(THAL_uk_fig)[names(THAL_uk_fig)=="THAL_rep_uk.Module"] <- "module"
names(THAL_uk_fig)[names(THAL_uk_fig)=="THAL_rep_uk.Gene"] <- "gene"
# Format columns
THAL_uk_fig$p.val <- as.numeric(THAL_uk_fig$p.val)
THAL_uk_fig$module <- as.character(THAL_uk_fig$module)
THAL_uk_fig$gene <- as.character(THAL_uk_fig$gene)
THAL_uk_fig <- dplyr::arrange(THAL_uk_fig, module)
THAL_uk_fig$position <- nrow(THAL_uk_fig):1
THAL_uk_fig$`-log10(p.val)` <- -log10(THAL_uk_fig$p.val)
THAL_uk_fig$FDR <- p.adjust(THAL_uk_fig$p.val, method = "fdr")
THAL_uk_fig$`-log10(FDR)` <- -log10(THAL_uk_fig$FDR)
# Create graph
ggplot(THAL_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "Thalamus", y = "Module", x = "Gene")
```

### White matter
```{r, results = FALSE, warning = FALSE}
# Search for gene list in dataset
WHMT_report_uk <- reportOnGenes(tissue = "WHMT", genes = NSL_uk_genes, which.one = "10UKBEC")
# Select report
WHMT_rep_uk <- WHMT_report_uk$report
# Count the number of genes in the output
WHMT_rep_uk_length <- nrow(WHMT_rep_uk)
# Convert report to table
WHMT_rep_uk <- data.frame(matrix(unlist(WHMT_rep_uk), nrow = WHMT_rep_uk_length, byrow = FALSE), stringsAsFactors=FALSE)
names(WHMT_rep_uk)[1] <- "Gene"
names(WHMT_rep_uk)[2] <- "ENSG"
names(WHMT_rep_uk)[3] <- "MM"
names(WHMT_rep_uk)[4] <- "Module"
names(WHMT_rep_uk)[5] <- "Size"
names(WHMT_rep_uk)[6] <- "GO_report"
names(WHMT_rep_uk)[7] <- "PD_genes"
names(WHMT_rep_uk)[8] <- "Preservation"
names(WHMT_rep_uk)[9] <- "Cell_type"
names(WHMT_rep_uk)[10] <- "Fisher"
for (i in NSL_list$uk_symbol) {
  loc <- match(i, NSL_list$uk_symbol)
  WHMT_rep_uk$Gene[WHMT_rep_uk$Gene == i] <- NSL_list$Gene_symbol[loc]
}
```

```{r}
# Extract columns of interest
WHMT_uk_fig <- data.frame(WHMT_rep_uk$Gene, WHMT_rep_uk$Module, WHMT_rep_uk$Fisher)
names(WHMT_uk_fig)[names(WHMT_uk_fig)=="WHMT_rep_uk.Fisher"] <- "p.val"
names(WHMT_uk_fig)[names(WHMT_uk_fig)=="WHMT_rep_uk.Module"] <- "module"
names(WHMT_uk_fig)[names(WHMT_uk_fig)=="WHMT_rep_uk.Gene"] <- "gene"
# Format columns
WHMT_uk_fig$p.val <- as.numeric(WHMT_uk_fig$p.val)
WHMT_uk_fig$module <- as.character(WHMT_uk_fig$module)
WHMT_uk_fig$gene <- as.character(WHMT_uk_fig$gene)
WHMT_uk_fig <- dplyr::arrange(WHMT_uk_fig, module)
WHMT_uk_fig$position <- nrow(WHMT_uk_fig):1
WHMT_uk_fig$`-log10(p.val)` <- -log10(WHMT_uk_fig$p.val)
WHMT_uk_fig$FDR <- p.adjust(WHMT_uk_fig$p.val, method = "fdr")
WHMT_uk_fig$`-log10(FDR)` <- -log10(WHMT_uk_fig$FDR)
# Create graph
ggplot(WHMT_uk_fig, aes(gene, reorder(module, position))) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR))) +
  scale_fill_gradient(low = "goldenrod3", high = "white") +
  labs(title = "White matter", y = "Module", x = "Gene")
```

## 3.2. Summary
```{r}
# Join together
CRBL_uk_fig$Tissue <- "Cerebellum"
FCTX_uk_fig$Tissue <- "Frontal Cortex"
HIPP_uk_fig$Tissue <- "Hippocampus"
MEDU_uk_fig$Tissue <- "Medulla"
OCTX_uk_fig$Tissue <- "Occipital Cortex"
PUTM_uk_fig$Tissue <- "Putamen"
SNIG_uk_fig$Tissue <- "Substantia Nigra"
TCTX_uk_fig$Tissue <- "Temporal Cortex"
THAL_uk_fig$Tissue <- "Thalamus"
WHMT_uk_fig$Tissue <- "White Matter"
sumfig_uk <- do.call(rbind, list(CRBL_uk_fig, FCTX_uk_fig, HIPP_uk_fig, MEDU_uk_fig, OCTX_uk_fig, PUTM_uk_fig, 
                                 SNIG_uk_fig, TCTX_uk_fig, THAL_uk_fig, WHMT_uk_fig))

# Format columns
sumfig_uk$gene <- as.character(sumfig_uk$gene)
sumfig_uk$`-log10(FDR)` <- as.numeric(sumfig_uk$`-log10(FDR)`)
sumfig_uk$FDR <- as.numeric(sumfig_uk$FDR)
sumfig_uk$Position <- nrow(sumfig_uk):1
# Plot
ggplot(sumfig_uk, aes(gene, module)) +
  geom_tile(aes(fill = `-log10(FDR)`)) +
  geom_text(aes(label = signif.num(FDR)), size = 2) +
  scale_fill_gradient(low = "white", high = "goldenrod3") +
  labs(y = "Module", x = "Gene") +
  facet_grid(Tissue ~ ., scales = "free", space = "free") +
  theme(strip.text.y = element_text(angle = 0), axis.text = element_text(size = 6))
```